# OrthoBridge
åŸºäºåºåˆ—ä»¥åŠblastçš„åŒæºåŸºå› è½¬æ¢


## åŸºäºè›‹ç™½è´¨åºåˆ—è¿›è¡ŒåŒæºåŸºå› è½¬æ¢

å¯¹äºäº²ç¼˜å…³ç³»éå¸¸è¿œçš„ç‰©ç§ï¼ŒåŸºäºDNAåºåˆ—è¿›è¡Œblastä¸å†åˆé€‚ï¼Œéœ€è¦æ ¹æ®è›‹ç™½è´¨åºåˆ—è¿›è¡Œblastï¼Œä»¥å¯¹éæ¨¡å¼åŠ¨ç‰©çš„åŸºå› è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šä¸è§£æã€‚

ä¸»è¦æ­¥éª¤åŒ…æ‹¬

- [1. Download nr.gz database from NCBI](#step1)
- [2. Extract specific species protein sequences from nr.gz](#step2)
- [3. Remove non-human information from redundant headers](#step3)
- [4. Construct a reference database in one step](#step4)
- [5. Batch download protein sequences from NCBI based on gene lists](#step5)
- [6. Obtain results by blastp comparison](#step6)

step1~3çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä»NCBIä¸Šä¸‹è½½nr databaseï¼Œä½†æ˜¯äº²æµ‹ä¸‹æ¥ï¼Œnrä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œè™½ç„¶nråŒ…å«äº†åŒä¸€ä¸ªåŸºå› çš„ä¸åŒè›‹ç™½è´¨çš„å¤šç§å˜ä½“ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨åšåŒæºè½¬æ¢çš„æ—¶å€™ä¸éœ€è¦
è¿™ä¹ˆè¯¦å°½çš„ä¿¡æ¯ï¼Œè€Œä¸”ä»**Accession ID**è½¬ä¸º**Symbol**ä¹Ÿæ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆé‡‡ç”¨äº†**Ensembl**æ•°æ®åº“æä¾›çš„äººç±»è›‹ç™½è´¨çš„fastaæ–‡ä»¶ï¼Œå…·ä½“ä½ç½®[åœ¨](https://ftp.ensembl.org/pub/release-113/fasta/homo_sapiens/pep/)ã€‚

è¿™ä¸ªfastaæ–‡ä»¶çš„headeré‡Œé¢æä¾›äº†è›‹ç™½è´¨å¯¹åº”çš„**Symbol**ä¿¡æ¯ï¼Œå¯ä»¥ç”¨`awk`å‘½ä»¤å°†å…¶ä¸­çš„ä¿¡æ¯æå–å‡ºæ¥ï¼Œæ–¹ä¾¿åç»­çš„è½¬æ¢ã€‚`acc_gene_symbols.txt`é™„ä»¶çš„æ–‡ä»¶æ˜¯å·²ç»åšå¥½çš„å¯¹åº”æ–‡ä»¶ã€‚å› æ­¤å¯ä»¥è·³è¿‡step1~3,ç›´æ¥ä»step4å¼€å§‹ã€‚

step5é’ˆå¯¹çš„æ˜¯åªæœ‰**Entrze ID**çš„éæ¨¡å¼ç”Ÿç‰©ï¼Œä¸èƒ½å¾ˆæ–¹ä¾¿çš„ä»**Uniprot**ä¸Šä¸‹è½½è›‹ç™½è´¨åºåˆ—ï¼Œéœ€è¦ä»NCBIä¸ŠæŸ¥è¯¢çš„ã€‚


------------

##### step1
### Download nr.gz database from NCBI

é¦–å…ˆä½¿ç”¨`ascp`é«˜é€Ÿä¸‹è½½nr.gzæ•°æ®åº“ï¼Œä¼˜ç‚¹æ˜¯ï¼šé€Ÿåº¦è¾ƒå¿«ï¼›å…è®¸æ–­ç‚¹ç»­ä¼ ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯`-i`å‚æ•°æä¾›**é“¾æ¥æ‰€éœ€çš„å¯†ä»¤æ–‡ä»¶**ï¼Œè¿™ä¸ªæ–‡ä»¶éœ€è¦æ ¹æ®è‡ªå·±**aspera**å®‰è£…çš„ä½ç½®æ›´æ¢è·¯å¾„ï¼Œå…¶ä»–å‚æ•°ä¸éœ€è¦æ”¹å˜ã€‚

ç›®å‰NCBIä¸å†æä¾›å•ç‹¬ç‰©ç§çš„è›‹ç™½è´¨åºåˆ—ï¼Œéœ€è¦å°†æ‰€æœ‰çš„åºåˆ—ä¸‹è½½åå•ç‹¬è¿›è¡Œæ„å»ºã€‚

æ­¤å¤–ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­**NCBI**ä¼¼ä¹å¯¹è®¿é—®æµé‡è¿›è¡Œäº†é™åˆ¶ï¼Œå®é™…ä¸‹è½½è¿‡ç¨‹ä¸­ï¼Œå¤§çº¦æ¯ä¸‹è½½**40G**å°±ä¼šä¸­æ–­ä¸€æ¬¡ï¼Œéœ€è¦é‡æ–°ä¸‹è½½ï¼Œæ‰€ä»¥æ–­ç‚¹ç»­ä¼ åŠŸèƒ½éå¸¸é‡è¦ã€‚

```
ascp -v -k 1 -QT -l 300M -i /home/bio/.aspera/connect/etc/asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:/blast/db/FASTA/nr.gz .
```

è¿™æ˜¯NCBIå¯¹åº”çš„[nr.gz](https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/)æ‰€åœ¨çš„ftpé“¾æ¥ä½ç½®ã€‚

------

##### step2
### 2. Extract specific species protein sequences from nr.gz

ç›®çš„æ˜¯å°†éæ¨¡å¼ç‰©ç§çš„è›‹ç™½å’Œäººçš„è›‹ç™½åºåˆ—è¿›è¡Œblastï¼Œæ‰€ä»¥è¦æ„å»ºäººçš„referenceã€‚

é¦–å…ˆæå–äººçš„åºåˆ—ï¼Œ**ä¸¤æ­¥æ³•**æ„å»ºï¼šç¬¬ä¸€æ­¥æå–äººçš„è›‹ç™½çš„headerï¼Œ

```
zgrep "^>.*Homo sapiens" nr.gz > human_headers.txt
```

ç¬¬äºŒæ­¥ï¼Œæ ¹æ®headersï¼Œä½¿ç”¨`seqkit`æ ¹æ®å…¨åæå–ï¼Œæ³¨æ„çš„æ˜¯seqkitè¯†åˆ«è¡Œåçš„æ—¶å€™ä¸èƒ½æœ‰`>`ï¼Œæ‰€ä»¥è¦å…ˆå»æ‰headersæ–‡ä»¶é‡Œé¢çš„`>`

```
sed 's/^>//' human_headers.txt > human_headers2.txt
seqkit grep -n -f human_headers2.txt nr.fa -o human_proteins.fa
```

**ä¸€æ­¥æ³•**æ„å»ºï¼š

```
seqkit grep -nrp "\[Homo sapiens\]" nr.fa > human_proteins.fasta
```

```
seqkit grep -nirp "Homo sapiens" nr.fa > human_proteins_2.fasta
```

å‡ºæ¥çš„ç»“æœä¸å®Œå…¨ä¸€æ ·,ç›®å‰è¿˜æ²¡æœ‰å‘ç°åˆ°åº•æ˜¯ä»€ä¹ˆé—®é¢˜ï¼ŒåªçŸ¥é“**Homo sapiens**æ˜¯å¦åŠ \[\]çš„ç»“æœä¸ä¸€æ ·ã€‚ä½†æ˜¯æ‰€å·®æ¡ç›®å¾ˆå°ï¼Œå†³å®šç”¨ç¬¬äºŒç§**ä¸€æ­¥æ³•**æ„å»ºçš„ç»“æœ

**nrï¼ˆéå†—ä½™è›‹ç™½æ•°æ®åº“ï¼‰é‡Œé¢ä¼šå‡ºç°headeré‡Œé¢åŒ…å«å¤šä¸ªidï¼Œä½†æ˜¯å‡ä»£è¡¨ä¸€æ¡åºåˆ—çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºä¸åŒçš„æ•°æ®åº“æ¡ç›®ï¼ˆå¦‚ RefSeqã€GenBankã€PDBï¼‰å¯èƒ½ä¼šå­˜å‚¨ç›¸åŒçš„è›‹ç™½è´¨åºåˆ—ï¼Œä½†å…·æœ‰ä¸åŒçš„æ¥æºæˆ–æ³¨é‡Šã€‚**

---------

##### step3
### 3. Remove non-human information from redundant headers

ç”±äºæˆ‘ä»¬çš„ç›®çš„æ˜¯æ„å»ºäººçš„referenceï¼Œæœ‰çš„è›‹ç™½è´¨åºåˆ—åŒ…å«äº†å¤šä¸ªç‰©ç§çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¸Œæœ›å»æ‰è¿™äº›ä¿¡æ¯ï¼Œä»…ä»…ä¿ç•™ä¸€æ¡äººçš„æ³¨é‡Šä¿¡æ¯ï¼Œå› ä¸ºåç»­æ¯”å¯¹ä¹Ÿä»…ä»…å¯ä»¥ç”Ÿæˆä¸€ä¸ª**acc id**çš„æ¯”å¯¹ç»“æœã€‚

å…·ä½“çš„æ€è·¯å°±æ˜¯æå–headerï¼Œæ ¹æ®ç‰¹å®šåˆ†éš”ç¬¦åˆ†å¼€ä¸åŒçš„ç‰©ç§æ³¨é‡Šä¿¡æ¯ï¼ŒåŒ¹é…**Homo sapiens**ï¼Œå¹¶å°†åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªè¾“å‡ºä¸ºæ–°çš„headerã€‚

**å€¼å¾—ä¸€æçš„æ˜¯ï¼Œnr.gzæ–‡ä»¶ä¸­headerå…¶å®æ˜¯æœ‰ä¸€ä¸ªåˆ†éš”ç¬¦åˆ†å¼€ä¸åŒçš„æ³¨é‡Šä¿¡æ¯çš„ï¼Œè¿™ä¸ªåˆ†éš”ç¬¦å°±æ˜¯\x01ï¼Œå¯è§†åŒ–é¡µé¢å¯èƒ½ä¼šçœ‹åˆ°^Aã€‚** 

æ‰€ä»¥æˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ¥è¿›è¡Œåˆ†éš”ï¼ŒåŸºäº`awk`å‘½ä»¤å†™äº†ä¸€ä¸ªè„šæœ¬ï¼š

```
#!/bin/bash

# æ£€æŸ¥æ˜¯å¦æä¾›äº†è¾“å…¥æ–‡ä»¶
if [ $# -eq 0 ]; then
    echo "Usage: $0 <fasta_file>"
    exit 1
fi

# è·å–è¾“å…¥æ–‡ä»¶å
input_file=$1

# å¤„ç†FASTAæ–‡ä»¶
awk '
/^>/ {
    # ç§»é™¤ ">" å¹¶æŒ‰ "]" åˆ†å‰²å­—ç¬¦ä¸²
    header = substr($0, 2)  # å»æ‰å¼€å¤´çš„ ">"
    split(header, parts, "\x01")

    # éå†åˆ‡åˆ†åçš„éƒ¨åˆ†ï¼ŒæŸ¥æ‰¾åŒ…å« "Homo sapiens" çš„å…ƒç´ 
    for (i in parts) {
        if (parts[i] ~ /Homo sapiens/) {
            # å¦‚æœæ‰¾åˆ° "Homo sapiens"ï¼Œç›´æ¥è¾“å‡ºè¯¥éƒ¨åˆ†
            print ">" parts[i]  # è¾“å‡ºåŒ…å« "Homo sapiens" çš„ header
            break
        }
    }
}
!/^>/ { print }  # è¾“å‡ºåŸå§‹çš„åºåˆ—éƒ¨åˆ†
' "$input_file" > "${input_file%.fasta}_cleaned.fasta"

echo "Processed file saved as ${input_file%.fasta}_cleaned.fasta"
```

è¿è¡Œ`sh process_fasta.sh human_proteins_2.fasta`å¯ä»¥ç”Ÿæˆä¸€ä¸ª`human_proteins_2_cleaned.fasta`æ–‡ä»¶ã€‚

-------

##### step4
### 4. Construct a reference database in one step

æ–°å»ºå¥½ä¸€ä¸ª`human_protein`æ–‡ä»¶å¤¹åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯ä»¥ç”Ÿæˆå¯¹åº”çš„å‚è€ƒæ•°æ®åº“ã€‚

```
makeblastdb -in human_proteins_2_cleaned.fasta -dbtype prot -title human_proteins -out human_proteins -parse_seqids
```
ç”Ÿæˆçš„æ•°æ®åº“ï¼Œbe likeâ€

```
$ ll
æ€»ç”¨é‡ 599596
drwxrwxr-x 2 bio bio     20480 3æœˆ  19 17:34 ./
drwxrwxr-x 4 bio bio      4096 3æœˆ  19 09:48 ../
-rw-rw-r-- 1 bio bio  90947584 3æœˆ  19 17:34 human_proteins.pdb
-rw-rw-r-- 1 bio bio 217405424 3æœˆ  19 17:34 human_proteins.phr
-rw-rw-r-- 1 bio bio  15047216 3æœˆ  19 17:34 human_proteins.pin
-rw-rw-r-- 1 bio bio       575 3æœˆ  19 17:34 human_proteins.pjs
-rw-rw-r-- 1 bio bio   7523588 3æœˆ  19 17:34 human_proteins.pog
-rw-rw-r-- 1 bio bio  37176871 3æœˆ  19 17:34 human_proteins.pos
-rw-rw-r-- 1 bio bio  22570676 3æœˆ  19 17:34 human_proteins.pot
-rw-rw-r-- 1 bio bio 215727409 3æœˆ  19 17:34 human_proteins.psq
-rw-rw-r-- 1 bio bio     16384 3æœˆ  19 17:34 human_proteins.ptf
-rw-rw-r-- 1 bio bio   7523560 3æœˆ  19 17:34 human_proteins.pto
```

----------

##### step5
### 5. Batch download protein sequences from NCBI based on gene lists

æˆ‘ä»¬åœ¨*Ixodes scapularis*ç‰©ç§çš„åŸºå› è¿›è¡Œåˆ†ææ—¶ï¼Œå‘ç°æ— æ³•ç›´æ¥é€šè¿‡å…¶åŸºå› IDåœ¨**uniprot**ä¸Šä¸‹è½½å¯¹åº”çš„åºåˆ—ï¼Œåªæœ‰ä»**NCBI**ä¸Šæ–¹ä¾¿æŸ¥é˜…ã€‚

NCBIæä¾›äº†`esearch`ç­‰å‘½ä»¤ï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨ç»ˆç«¯é€šè¿‡ç½‘ç»œè®¿é—®**NCBI**è¿›è¡ŒæŸ¥è¯¢ã€‚

```
esearch -db gene -query "8033311 [uid] AND Ixodes scapularis [ORGN]" |   elink -target protein |   efetch -format fasta
```

è¿™ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥é€šè¿‡**Entrze ID**ä¾‹å¦‚**8033311**è·å¾—å…¶å¯¹åº”çš„è›‹ç™½è´¨åºåˆ—ã€‚

å¦‚æœçŸ¥é“çš„æ˜¯**Symbol**è€Œä¸æ˜¯**Entrze ID**ï¼Œåªéœ€è¦å°†**uid**æ¢æˆ**GENE**ï¼š

```
esearch -db gene -query "FASN1 [GENE] AND Ixodes scapularis [ORGN]" |   elink -target protein |   efetch -format fasta
```

è¿™ä¸ªå‘½ä»¤éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæ˜¯ï¼š1.ä¸€ä¸ªåŸºå› å¯èƒ½å¯¹åº”ä¸€ä¸ªè›‹ç™½è´¨ï¼Œä¹Ÿå¯èƒ½å¯¹åº”å¤šä¸ªè›‹ç™½è´¨ï¼Œè¿˜å¯èƒ½å› ä¸ºæ˜¯éç¼–ç RNAä¸å¯¹åº”è›‹ç™½è´¨ï¼Œå°½ç®¡å¤šä¸ªè›‹ç™½è´¨èƒ½å¤Ÿé¡ºåˆ©è¾“å‡ºï¼Œä½†æ˜¯æˆ‘ä»¬è¿›è¡Œæ‰¹é‡ä¸‹è½½çš„æ—¶å€™ï¼Œå¾ˆéš¾å†å›æº¯å›å»ï¼Œå°†æˆ‘ä»¬çš„**Entrze ID**
å’Œè›‹ç™½è´¨çš„**acc id**å¯¹åº”èµ·æ¥ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è¿›è¡Œä»£ç çš„ä¼˜åŒ–ï¼Œæ·»åŠ idè½¬æ¢çš„æ–‡ä»¶ï¼›2.æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨æ‰¹é‡ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç°shellè„šæœ¬ä¸­çš„`while do; done`æ— æ³•é¡ºåˆ©çš„å¾ªç¯è¾“å‡ºï¼Œå¸¸è§„çš„å¾ªç¯ä¹Ÿä¼šå¯¼è‡´å¯¹**NCBI**èŠ‚ç‚¹ç¬æ—¶å¤§æ‰¹é‡è®¿é—®ï¼Œå¯¼è‡´è¯·æ±‚è¢«æ‹’ç»ï¼Œæœ€ç»ˆ
æ‰ç”¨äº†ä¸€ä¸ªå¾ˆç¬¨çš„åŠæ³•ï¼Œå³å¯¹æ¯ä¸ªå•ç‹¬çš„**Entrze ID**ç”Ÿæˆä¸€ä¸ªæŸ¥è¯¢å¹¶ä¸‹è½½çš„è„šæœ¬ï¼Œåœ¨ä¾æ¬¡æäº¤ï¼Œè¿™æ ·ä¼šå¯¼è‡´æŸ¥è¯¢é€Ÿåº¦å¾ˆæ…¢ï¼Œä½†æ˜¯èƒ½å¤Ÿç¨³å®šçš„ä¸‹è½½åºåˆ—ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¤§æ¦‚æ˜¯ï¼š16000ä¸ªåŸºå› èŠ±äº†ä¸¤å¤©åŠçš„æ—¶é—´ã€‚

ä¸‹é¢æ˜¯å¯¹åº”çš„æ€»è„šæœ¬ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ï¼š1.æ ¹æ®**Entrze ID**åˆ—è¡¨æ–‡ä»¶ç”Ÿæˆæ¯ä¸ªåŸºå› çš„å•ç‹¬æŸ¥è¯¢æ–‡ä»¶ï¼›2.å°†**Entrze ID**ä¸**Acc id**å¯¹åº”å…³ç³»è¾“å‡ºåˆ°**gene_protein_map.txt**æ–‡ä»¶ï¼›3.æœ€ç»ˆé€šè¿‡**ä¸²è¡Œæ‰§è¡Œ**è¿˜æ˜¯**å¹¶è¡Œæ‰§è¡Œ**æäº¤ç”Ÿæˆçš„è„šæœ¬ï¼Œç›®å‰ä»…æ”¯æŒ
**ä¸²è¡Œæ‰§è¡Œ**ï¼Œé˜²æ­¢ç¬æ—¶è®¿é—®æ¬¡æ•°è¿‡å¤šã€‚

```
#!/bin/bash

# æ£€æŸ¥æ˜¯å¦ä¼ å…¥åŸºå› åˆ—è¡¨æ–‡ä»¶
if [ "$#" -ne 1 ]; then
    echo "âŒ è¯·æä¾›åŸºå› åˆ—è¡¨æ–‡ä»¶ä½œä¸ºå‚æ•°"
    echo "ç”¨æ³•: $0 gene_list.txt"
    exit 1
fi

# è¾“å…¥åŸºå› åˆ—è¡¨æ–‡ä»¶
gene_list_file=$1

# åˆ›å»ºå­˜æ”¾è„šæœ¬çš„ç›®å½•
mkdir -p gene_scripts
rm -f gene_scripts/run_*.sh gene_protein_map.txt  # æ¸…ç©ºæ—§è„šæœ¬å’Œæ˜ å°„æ–‡ä»¶

# è¯»å–åŸºå› åˆ—è¡¨æ–‡ä»¶å¹¶éå†
while IFS= read -r gene || [[ -n "$gene" ]]; do
    # ç¡®ä¿ gene å˜é‡æ­£ç¡®èµ‹å€¼
    if [[ -z "$gene" ]]; then
        continue
    fi

    script_file="gene_scripts/run_${gene}.sh"

    # ç”Ÿæˆç‹¬ç«‹çš„è¿è¡Œè„šæœ¬
    cat <<EOF > "$script_file"
#!/bin/bash
echo 'ğŸ” å¤„ç†åŸºå› : $gene'
protein_ids=\$(esearch -db gene -query "$gene [UID] AND Ixodes scapularis [ORGN]" | \\
  elink -target protein | \\
  efetch -format uid | grep -E '^[0-9]+\$')

if [[ -n "\$protein_ids" ]]; then
    refseq_ids=\$(for id in \$protein_ids; do efetch -db protein -id "\$id" -format acc; done | tr '\n' ',')  # å°†æ‰€æœ‰acc IDåˆå¹¶æˆä¸€è¡Œ
    echo "  âœ… æ‰¾åˆ°è›‹ç™½ RefSeq IDs: \$refseq_ids"
    echo "$gene \$refseq_ids" >> gene_protein_map.txt  # è®°å½•åŸºå›  ID å’Œè›‹ç™½ RefSeq ID
    for refseq_id in \$refseq_ids; do
        efetch -db protein -id "\$refseq_id" -format fasta >> Ixodes_proteins.fasta
    done
else
    echo "  âš ï¸ æœªæ‰¾åˆ°è›‹ç™½è´¨ RefSeq IDï¼Œè·³è¿‡ $gene"
    echo "$gene NONE" >> gene_protein_map.txt  # è®°å½•æœªæ‰¾åˆ°çš„æƒ…å†µ
fi
EOF

    chmod +x "$script_file"  # èµ‹äºˆå¯æ‰§è¡Œæƒé™
    echo "âœ… ç”Ÿæˆä»»åŠ¡: $script_file"  # è®©ç”¨æˆ·çœ‹åˆ°ç”Ÿæˆçš„è„šæœ¬
done < "$gene_list_file"

echo "âœ… æ‰€æœ‰ä»»åŠ¡è„šæœ¬å·²ç”Ÿæˆï¼Œå­˜æ”¾äº gene_scripts/ ç›®å½•ä¸‹ã€‚"

# é€‰æ‹©æ‰§è¡Œæ–¹å¼
echo "å¦‚ä½•æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Ÿ"
echo "1) ä¸²è¡Œæ‰§è¡Œï¼ˆé€‚ç”¨äºå°é‡ä»»åŠ¡ï¼‰"
echo "2) å¹¶è¡Œæ‰§è¡Œï¼ˆé€‚ç”¨äºå¤§é‡ä»»åŠ¡ï¼Œéœ€è¦ parallelï¼‰"
read -p "é€‰æ‹©æ‰§è¡Œæ¨¡å¼ (1/2): " mode

if [[ "$mode" == "1" ]]; then
    echo "ğŸš€ ä¸²è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡..."
    for script in gene_scripts/run_*.sh; do
        bash "$script"
    done
elif [[ "$mode" == "2" ]]; then
    if command -v parallel &>/dev/null; then
        echo "ğŸš€ å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡..."
        parallel bash ::: gene_scripts/run_*.sh
    else
        echo "âš ï¸ æœªå®‰è£… parallelï¼Œè¯·ä½¿ç”¨ 'sudo apt install parallel' æˆ– 'brew install parallel' å®‰è£…ã€‚"
    fi
else
    echo "âŒ æ— æ•ˆé€‰æ‹©ï¼Œè„šæœ¬å·²é€€å‡ºã€‚"
fi
```
æ‰§è¡Œæ–¹å¼ä¸º`sh generate_and_run.sh your_gene_list.txt`ï¼Œ`your_gene_list.txt`æ–‡ä»¶ç±»ä¼¼äºï¼š

```
8030992
8033311
121835630
8041617
115309236
```

æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘½ä»¤è¡Œä¼šæ‰“å°æ‰§è¡Œçš„è¿›åº¦ï¼Œç±»ä¼¼äºï¼š

```
ğŸ” å¤„ç†åŸºå› : 8054078
  âœ… æ‰¾åˆ°è›‹ç™½ RefSeq IDs: XP_029848343.1,
ğŸ” å¤„ç†åŸºå› : 8054079
  âœ… æ‰¾åˆ°è›‹ç™½ RefSeq IDs: XP_029848341.1,XP_029848342.1,
ğŸ” å¤„ç†åŸºå› : 8054081
  âœ… æ‰¾åˆ°è›‹ç™½ RefSeq IDs: XP_029848345.1,XP_029848346.1,
ğŸ” å¤„ç†åŸºå› : 8054090
  âœ… æ‰¾åˆ°è›‹ç™½ RefSeq IDs: XP_040356995.1,XP_040356997.1,
ğŸ” å¤„ç†åŸºå› : LGTVgp1
  âš ï¸ æœªæ‰¾åˆ°è›‹ç™½è´¨ RefSeq IDï¼Œè·³è¿‡ LGTVgp1
```

è¾“å‡ºçš„`gene_protein_map.txt`æ–‡ä»¶ç±»ä¼¼äºï¼š

```
115308162 XP_040067104.2,
115308164 XP_029842035.2,XP_029842036.2,
115308165 XP_029826729.1,
115308168 XP_029833004.2,XP_029833006.2,XP_029833007.2,XP_042145751.1,
115308169 XP_040360673.2,
```

-------------

##### step6
### 6. Obtain results by blastp comparison

```
blastp -query Ixodes_proteins.fasta -db /home/Toshiba4/blast_db/human_protein/human_proteins -out panjun_Ixodes_to_human_transfer.txt -evalue 1e-5 -outfmt 6 -num_threads 64
```
è¿è¡Œä»¥ä¸Šä»£ç ï¼Œç›´æ¥è·å¾—è¡¨æ ¼æ ¼å¼çš„æ¯”å¯¹ç»“æœã€‚ç»“æœç±»ä¼¼äºï¼š

```
XP_040067104.2	NP_055569.1	57.019	463	179	5	9	451	7	469	0.0	519
XP_040067104.2	BAF85725.1	56.803	463	180	5	9	451	7	469	0.0	519
XP_040067104.2	NP_001277154.1	54.969	322	131	3	144	451	2	323	3.93e-125	369
XP_040067104.2	AAH04502.2	54.517	321	132	3	145	451	7	327	1.34e-123	365
XP_040067104.2	KAI2550776.1	54.508	244	106	2	201	439	2	245	2.65e-90	279
XP_040067104.2	NP_110410.1	34.054	370	232	5	7	367	33	399	5.53e-70	233
XP_040067104.2	NP_001316477.1	35.191	341	209	5	36	367	2	339	3.00e-67	224
XP_040067104.2	XP_047283599.1	35.191	341	209	5	36	367	34	371	5.92e-67	224
XP_040067104.2	NP_001316473.1	32.642	386	232	6	7	367	33	415	1.14e-65	222
XP_040067104.2	XP_024304467.1	33.613	357	209	6	36	367	2	355	3.56e-63	214
XP_040067104.2	NP_001316474.1	39.267	191	114	2	178	367	1	190	3.85e-43	156
XP_040067104.2	EAW91753.1	64.706	85	25	1	9	88	7	91	2.71e-27	108
XP_029842035.2	CAG5082931.1	32.530	166	100	3	41	199	30	190	1.45e-10	65.9
XP_029842036.2	CAG5082931.1	32.530	166	100	3	29	187	30	190	1.01e-10	65.9
XP_029826729.1	NP_055302.1	69.565	253	75	1	1	253	1	251	9.18e-134	385
XP_029826729.1	BAD97329.1	69.170	253	76	1	1	253	1	251	6.28e-133	383
XP_029826729.1	KAI2535999.1	72.489	229	63	0	1	229	1	229	5.43e-128	367
XP_029826729.1	NP_001278931.1	71.585	183	50	1	71	253	11	191	5.93e-95	285
XP_029826729.1	BAG57430.1	71.038	183	51	1	71	253	11	191	5.42e-94	282
XP_029826729.1	KAI2536000.1	70.588	153	45	0	1	153	1	153	2.01e-81	246
XP_029826729.1	KAI2536001.1	69.286	140	43	0	1	140	1	140	6.07e-72	221
XP_029826729.1	KAI2536002.1	60.000	50	20	0	1	50	1	50	1.11e-11	63.2
XP_029833004.2	2Y3I_A	72.330	412	113	1	4	414	5	416	0.0	608
XP_029833004.2	NP_000282.1	72.330	412	113	1	4	414	5	416	0.0	608
XP_029833004.2	3C39_A	72.330	412	113	1	4	414	8	419	0.0	608
XP_029833004.2	2WZB_A	72.330	412	113	1	4	414	4	415	0.0	608
```

æ¯ä¸ªåºåˆ—ä¼šè¾“å‡ºtop matchçš„ä¸€äº›ç»“æœã€‚

1. ä½¿ç”¨`awk '!seen[$1]++' panjun_Ixodes_to_human_transfer.txt > best_hits.txt` å¯ä»¥è·å¾—top1çš„matchç»“æœ

2. ä½¿ç”¨`awk '$3 >= 90' results.txt > high_identity_hits.txt` å¯ä»¥æ ¹æ®åºåˆ—ç›¸ä¼¼åº¦è¿‡æ»¤ç‰¹å®šç»“æœã€‚




